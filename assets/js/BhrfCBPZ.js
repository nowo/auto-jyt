import{l as e,b as a,r as t,n as l,q as n,y as r,aA as u,A as i,V as s,Y as o,a7 as m,I as d,u as c,al as p,$ as v,W as b,X as f,a6 as N,aq as y,a9 as V,R as g}from"./qvIHbRqB.js";import{E as x}from"./DnlF_OhZ.js";import{o as h,U as E,q as I,r as S,a7 as A,v as _,y as F,z as $,ag as w,af as k,b_ as B,D as M,ae as D,b$ as j,N as K,c0 as O,O as R,P as z}from"#entry";import{U as C,I as G,C as T,u as q,t as L,d as P}from"./BGjgMdPk.js";import{v as X}from"./C-SUzy-B.js";import{a as U,c as W,u as Y}from"./DePlfNGU.js";const H=I({id:{type:String,default:void 0},step:{type:Number,default:1},stepStrictly:Boolean,max:{type:Number,default:Number.MAX_SAFE_INTEGER},min:{type:Number,default:Number.MIN_SAFE_INTEGER},modelValue:{type:[Number,null]},readonly:Boolean,disabled:Boolean,size:A,controls:{type:Boolean,default:!0},controlsPosition:{type:String,default:"",values:["","right"]},valueOnClear:{type:[String,Number,null],validator:e=>null===e||h(e)||["min","max"].includes(e),default:null},name:String,placeholder:String,precision:{type:Number,validator:e=>e>=0&&e===Number.parseInt(`${e}`,10)},validateEvent:{type:Boolean,default:!0},...q(["ariaLabel"]),inputmode:{type:S(String),default:void 0},align:{type:S(String),default:"center"},disabledScientific:Boolean}),J={[T]:(e,a)=>a!==e,blur:e=>e instanceof FocusEvent,focus:e=>e instanceof FocusEvent,[G]:e=>h(e)||E(e),[C]:e=>h(e)||E(e)},Q=e({name:"ElInputNumber"});const Z=z(_(e({...Q,props:H,emits:J,setup(e,{expose:I,emit:S}){const A=e,{t:_}=F(),z=$("input-number"),q=a(),H=t({currentValue:A.modelValue,userInput:null}),{formItem:J}=U(),Q=l(()=>h(A.modelValue)&&A.modelValue<=A.min),Z=l(()=>h(A.modelValue)&&A.modelValue>=A.max),ee=l(()=>{const e=ue(A.step);return w(A.precision)?Math.max(ue(A.modelValue),e):(A.precision,A.precision)}),ae=l(()=>A.controls&&"right"===A.controlsPosition),te=W(),le=Y(),ne=l(()=>{if(null!==H.userInput)return H.userInput;let e=H.currentValue;if(E(e))return"";if(h(e)){if(Number.isNaN(e))return"";w(A.precision)||(e=e.toFixed(A.precision))}return e}),re=(e,a)=>{if(w(a)&&(a=ee.value),0===a)return Math.round(e);let t=String(e);const l=t.indexOf(".");if(-1===l)return e;if(!t.replace(".","").split("")[l+a])return e;const n=t.length;return"5"===t.charAt(n-1)&&(t=`${t.slice(0,Math.max(0,n-1))}6`),Number.parseFloat(Number(t).toFixed(a))},ue=e=>{if(E(e))return 0;const a=e.toString(),t=a.indexOf(".");let l=0;return-1!==t&&(l=a.length-t-1),l},ie=(e,a=1)=>h(e)?e>=Number.MAX_SAFE_INTEGER&&1===a||e<=Number.MIN_SAFE_INTEGER&&-1===a?e:re(e+A.step*a):H.currentValue,se=e=>{const a=K(e),t=O(e);if(A.disabledScientific&&["e","E"].includes(t))e.preventDefault();else switch(a){case R.up:e.preventDefault(),oe();break;case R.down:e.preventDefault(),me()}},oe=()=>{if(A.readonly||le.value||Z.value)return;const e=Number(ne.value)||0,a=ie(e);ce(a),S(G,H.currentValue),Ne()},me=()=>{if(A.readonly||le.value||Q.value)return;const e=Number(ne.value)||0,a=ie(e,-1);ce(a),S(G,H.currentValue),Ne()},de=(e,a)=>{const{max:t,min:l,step:n,precision:r,stepStrictly:u,valueOnClear:i}=A;t<l&&L("InputNumber","min should not be greater than max.");let s=Number(e);if(E(e)||Number.isNaN(s))return null;if(""===e){if(null===i)return null;s=g(i)?{min:l,max:t}[i]:i}return u&&(s=re(Math.round(s/n)*n,r),s!==e&&a&&S(C,s)),w(r)||(s=re(s,r)),(s>t||s<l)&&(s=s>t?t:l,a&&S(C,s)),s},ce=(e,a=!0)=>{var t;const l=H.currentValue,n=de(e);a?l===n&&e||(H.userInput=null,S(C,n),l!==n&&S(T,n,l),A.validateEvent&&(null==(t=null==J?void 0:J.validate)||t.call(J,"change").catch(e=>P())),H.currentValue=n):S(C,n)},pe=e=>{H.userInput=e;const a=""===e?null:Number(e);S(G,a),ce(a,!1)},ve=e=>{const a=""!==e?Number(e):"";(h(a)&&!Number.isNaN(a)||""===e)&&ce(a),Ne(),H.userInput=null},be=e=>{S("focus",e)},fe=e=>{var a,t;H.userInput=null,null===H.currentValue&&(null==(a=q.value)?void 0:a.input)&&(q.value.input.value=""),S("blur",e),A.validateEvent&&(null==(t=null==J?void 0:J.validate)||t.call(J,"blur").catch(e=>P()))},Ne=()=>{H.currentValue!==A.modelValue&&(H.currentValue=A.modelValue)},ye=e=>{document.activeElement===e.target&&e.preventDefault()};return n(()=>A.modelValue,(e,a)=>{const t=de(e,!0);null===H.userInput&&t!==a&&(H.currentValue=t)},{immediate:!0}),n(()=>A.precision,()=>{H.currentValue=de(A.modelValue)}),r(()=>{var e;const{min:a,max:t,modelValue:l}=A,n=null==(e=q.value)?void 0:e.input;if(n.setAttribute("role","spinbutton"),Number.isFinite(t)?n.setAttribute("aria-valuemax",String(t)):n.removeAttribute("aria-valuemax"),Number.isFinite(a)?n.setAttribute("aria-valuemin",String(a)):n.removeAttribute("aria-valuemin"),n.setAttribute("aria-valuenow",H.currentValue||0===H.currentValue?String(H.currentValue):""),n.setAttribute("aria-disabled",String(le.value)),!h(l)&&null!=l){let e=Number(l);Number.isNaN(e)&&(e=null),S(C,e)}n.addEventListener("wheel",ye,{passive:!1})}),u(()=>{var e,a;const t=null==(e=q.value)?void 0:e.input;null==t||t.setAttribute("aria-valuenow",`${null!=(a=H.currentValue)?a:""}`)}),I({focus:()=>{var e,a;null==(a=null==(e=q.value)?void 0:e.focus)||a.call(e)},blur:()=>{var e,a;null==(a=null==(e=q.value)?void 0:e.blur)||a.call(e)}}),(e,a)=>(s(),i("div",{class:v([c(z).b(),c(z).m(c(te)),c(z).is("disabled",c(le)),c(z).is("without-controls",!e.controls),c(z).is("controls-right",c(ae)),c(z).is(e.align,!!e.align)]),onDragstart:V(()=>{},["prevent"])},[e.controls?o((s(),i("span",{key:0,role:"button","aria-label":c(_)("el.inputNumber.decrease"),class:v([c(z).e("decrease"),c(z).is("disabled",c(Q))]),onKeydown:p(me,["enter"])},[b(e.$slots,"decrease-icon",{},()=>[d(c(M),null,{default:f(()=>[c(ae)?(s(),N(c(k),{key:0})):(s(),N(c(B),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[c(X),me]]):m("v-if",!0),e.controls?o((s(),i("span",{key:1,role:"button","aria-label":c(_)("el.inputNumber.increase"),class:v([c(z).e("increase"),c(z).is("disabled",c(Z))]),onKeydown:p(oe,["enter"])},[b(e.$slots,"increase-icon",{},()=>[d(c(M),null,{default:f(()=>[c(ae)?(s(),N(c(D),{key:0})):(s(),N(c(j),{key:1}))]),_:1})])],42,["aria-label","onKeydown"])),[[c(X),oe]]):m("v-if",!0),d(c(x),{id:e.id,ref_key:"input",ref:q,type:"number",step:e.step,"model-value":c(ne),placeholder:e.placeholder,readonly:e.readonly,disabled:c(le),size:c(te),max:e.max,min:e.min,name:e.name,"aria-label":e.ariaLabel,"validate-event":!1,inputmode:e.inputmode,onKeyup:se,onBlur:fe,onFocus:be,onInput:pe,onChange:ve},y({_:2},[e.$slots.prefix?{name:"prefix",fn:f(()=>[b(e.$slots,"prefix")])}:void 0,e.$slots.suffix?{name:"suffix",fn:f(()=>[b(e.$slots,"suffix")])}:void 0]),1032,["id","step","model-value","placeholder","readonly","disabled","size","max","min","name","aria-label","inputmode"])],42,["onDragstart"]))}}),[["__file","input-number.vue"]]));export{Z as E};
